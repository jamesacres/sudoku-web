{
  "analysis_date": "2025-11-03",
  "files_analyzed": 3,
  "summary": {
    "total_app_specific_dependencies": 2,
    "fully_movable_files": 1,
    "partially_movable_files": 2,
    "recommendation": "All three files can be moved to packages/sudoku with minor adjustments to relative import paths"
  },
  "files": [
    {
      "file_path": "/home/node/sudoku-web/apps/sudoku/src/components/leaderboard/scoringConfig.ts",
      "file_type": "TypeScript Configuration",
      "file_size": "1.4 KB",
      "description": "Configuration constants for puzzle scoring system including base scores, difficulty multipliers, and speed bonuses",
      "imports": [
        {
          "import": "Difficulty",
          "source": "@sudoku-web/template",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        },
        {
          "import": "BookPuzzleDifficulty",
          "source": "@sudoku-web/sudoku",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        }
      ],
      "exports": [
        {
          "name": "SCORING_CONFIG",
          "type": "constant object",
          "usage": "Configuration export with scoring rules"
        }
      ],
      "dependencies_analysis": {
        "has_app_specific_deps": false,
        "has_relative_imports": false,
        "has_file_system_access": false,
        "has_react_dependencies": false,
        "shared_package_deps": [
          "@sudoku-web/template",
          "@sudoku-web/sudoku"
        ]
      },
      "associated_tests": [],
      "test_files_found": false,
      "moveability": {
        "can_move": true,
        "moveability_score": "100%",
        "issues": [],
        "required_changes": [],
        "target_location": "packages/sudoku/src/helpers/scoringConfig.ts",
        "import_path_after_move": "@sudoku-web/sudoku"
      },
      "used_by": [
        {
          "file": "apps/sudoku/src/components/leaderboard/scoringUtils.ts",
          "import_type": "relative",
          "current_path": "./scoringConfig"
        }
      ]
    },
    {
      "file_path": "/home/node/sudoku-web/apps/sudoku/src/components/leaderboard/scoringUtils.ts",
      "file_type": "TypeScript Utility",
      "file_size": "5.8 KB",
      "description": "Scoring calculation utilities for leaderboard including speed bonuses, racing bonuses, and user score calculation",
      "imports": [
        {
          "import": "ServerStateResult, Party",
          "source": "@sudoku-web/sudoku",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        },
        {
          "import": "ServerState",
          "source": "@sudoku-web/sudoku",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        },
        {
          "import": "isPuzzleCheated",
          "source": "@/helpers/cheatDetection",
          "type": "named",
          "app_specific": true,
          "classification": "Relative Path (App-specific)"
        },
        {
          "import": "SCORING_CONFIG",
          "source": "./scoringConfig",
          "type": "named",
          "app_specific": true,
          "classification": "Relative Path (Local)"
        },
        {
          "import": "PuzzleType, ScoringResult, AllFriendsSessionsMap",
          "source": "./types",
          "type": "named",
          "app_specific": true,
          "classification": "Relative Path (Local)"
        }
      ],
      "exports": [
        {
          "name": "getPuzzleType",
          "type": "function",
          "parameters": ["session: ServerStateResult<ServerState>"],
          "returns": "PuzzleType"
        },
        {
          "name": "getPuzzleIdentifier",
          "type": "function",
          "parameters": ["session: ServerStateResult<ServerState>"],
          "returns": "string"
        },
        {
          "name": "calculateSpeedBonus",
          "type": "function",
          "parameters": ["completionTimeSeconds: number"],
          "returns": "number"
        },
        {
          "name": "calculateRacingBonus",
          "type": "function",
          "parameters": ["userSession", "allFriendsSessions", "currentUserId"],
          "returns": "{ bonus: number; wins: number }"
        },
        {
          "name": "calculateUserScore",
          "type": "function",
          "parameters": ["userSessions", "allFriendsSessions", "currentUserId"],
          "returns": "ScoringResult"
        },
        {
          "name": "formatTime",
          "type": "function",
          "parameters": ["seconds: number"],
          "returns": "string"
        },
        {
          "name": "getUsernameFromParties",
          "type": "function",
          "parameters": ["userId: string", "parties: Party[]"],
          "returns": "string"
        }
      ],
      "dependencies_analysis": {
        "has_app_specific_deps": true,
        "has_relative_imports": true,
        "has_file_system_access": false,
        "has_react_dependencies": false,
        "shared_package_deps": [
          "@sudoku-web/sudoku"
        ],
        "local_relative_deps": [
          "./scoringConfig",
          "./types",
          "@/helpers/cheatDetection"
        ]
      },
      "associated_tests": [
        "/home/node/sudoku-web/apps/sudoku/src/components/leaderboard/scoringUtils.test.ts"
      ],
      "test_files_found": true,
      "test_coverage": {
        "test_file_location": "/home/node/sudoku-web/apps/sudoku/src/components/leaderboard/scoringUtils.test.ts",
        "test_file_size": "9.1 KB",
        "number_of_tests": 30,
        "test_suites": [
          "getPuzzleType (5 tests)",
          "calculateSpeedBonus (6 tests)",
          "calculateRacingBonus (5 tests)",
          "calculateUserScore (7 tests)",
          "formatTime (6 tests)",
          "getUsernameFromParties (4 tests)"
        ]
      },
      "moveability": {
        "can_move": true,
        "moveability_score": "90%",
        "issues": [
          "Has relative import to @/helpers/cheatDetection - needs adjustment after move",
          "Depends on sibling files (scoringConfig, types) - those must move together"
        ],
        "required_changes": [
          "Change relative import: @/helpers/cheatDetection -> @sudoku-web/sudoku (if cheatDetection moves to packages)",
          "Change relative import: ./scoringConfig -> ./scoringConfig (local, no change needed if in same directory)",
          "Change relative import: ./types -> ./types (local, no change needed if in same directory)",
          "Update test file to move along with source file"
        ],
        "target_location": "packages/sudoku/src/helpers/scoringUtils.ts",
        "import_path_after_move": "@sudoku-web/sudoku",
        "dependent_files_must_move_together": [
          "scoringConfig.ts",
          "types.ts",
          "cheatDetection.ts"
        ]
      },
      "used_by": [
        {
          "file": "apps/sudoku/src/components/leaderboard/Leaderboard.tsx",
          "import_type": "relative",
          "current_path": "./scoringUtils"
        }
      ]
    },
    {
      "file_path": "/home/node/sudoku-web/apps/sudoku/src/helpers/cheatDetection.ts",
      "file_type": "TypeScript Utility",
      "file_size": "2.1 KB",
      "description": "Cheat detection logic that analyzes puzzle state changes to identify when more than one cell was modified between states",
      "imports": [
        {
          "import": "Puzzle",
          "source": "@sudoku-web/sudoku",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        },
        {
          "import": "ServerState",
          "source": "@sudoku-web/sudoku",
          "type": "named",
          "app_specific": false,
          "classification": "Shared Package"
        }
      ],
      "exports": [
        {
          "name": "isPuzzleCheated",
          "type": "function",
          "parameters": ["gameStateOrAnswerStack: ServerState | Puzzle[]"],
          "returns": "boolean",
          "description": "Detects cheating by checking if more than one cell changed between two puzzle states"
        }
      ],
      "dependencies_analysis": {
        "has_app_specific_deps": false,
        "has_relative_imports": false,
        "has_file_system_access": false,
        "has_react_dependencies": false,
        "shared_package_deps": [
          "@sudoku-web/sudoku"
        ]
      },
      "associated_tests": [
        "/home/node/sudoku-web/apps/sudoku/src/helpers/cheatDetection.test.ts"
      ],
      "test_files_found": true,
      "test_coverage": {
        "test_file_location": "/home/node/sudoku-web/apps/sudoku/src/helpers/cheatDetection.test.ts",
        "test_file_size": "7.2 KB",
        "number_of_tests": 24,
        "test_suites": [
          "isPuzzleCheated with Puzzle array input (8 tests)",
          "isPuzzleCheated with ServerState input (5 tests)",
          "edge cases (5 tests)",
          "integration scenarios (1 test with multiple checks)"
        ]
      },
      "moveability": {
        "can_move": true,
        "moveability_score": "100%",
        "issues": [],
        "required_changes": [
          "Move test file to packages/sudoku/src/helpers/cheatDetection.test.ts"
        ],
        "target_location": "packages/sudoku/src/helpers/cheatDetection.ts",
        "import_path_after_move": "@sudoku-web/sudoku",
        "import_path_examples": [
          "import { isPuzzleCheated } from '@sudoku-web/sudoku';"
        ]
      },
      "used_by": [
        {
          "file": "apps/sudoku/src/components/leaderboard/scoringUtils.ts",
          "import_type": "relative",
          "current_path": "@/helpers/cheatDetection"
        }
      ]
    }
  ],
  "summary_statistics": {
    "total_imports": 11,
    "imports_from_shared_packages": 7,
    "imports_from_relative_paths": 4,
    "test_files_count": 2,
    "total_test_cases": 54,
    "files_with_dependencies": 2,
    "files_without_dependencies": 1
  },
  "moveability_recommendations": {
    "move_order": [
      "1. Move cheatDetection.ts (no dependencies on other files to be moved)",
      "2. Move scoringConfig.ts (no dependencies on other files to be moved)",
      "3. Move types.ts (no dependencies on other files to be moved)",
      "4. Move scoringUtils.ts (depends on cheatDetection, scoringConfig, and types)"
    ],
    "package_exports_to_add": [
      "export { isPuzzleCheated } from './helpers/cheatDetection';",
      "export { SCORING_CONFIG } from './helpers/scoringConfig';",
      "export { calculateUserScore, calculateSpeedBonus, calculateRacingBonus, getPuzzleType, formatTime, getUsernameFromParties } from './helpers/scoringUtils';",
      "export type { ScoringResult, PuzzleType, AllFriendsSessionsMap } from './helpers/types';"
    ],
    "app_imports_to_update_after_move": [
      "Change: import { isPuzzleCheated } from '@/helpers/cheatDetection'",
      "To: import { isPuzzleCheated } from '@sudoku-web/sudoku';",
      "Change: import { SCORING_CONFIG } from './scoringConfig'",
      "To: import { SCORING_CONFIG } from '@sudoku-web/sudoku';",
      "Change: import { getPuzzleType, ... } from './scoringUtils'",
      "To: import { getPuzzleType, ... } from '@sudoku-web/sudoku';"
    ]
  },
  "risk_assessment": {
    "overall_risk": "LOW",
    "risk_factors": [
      {
        "factor": "No React components",
        "severity": "none",
        "impact": "Can be moved without concern for component tree"
      },
      {
        "factor": "No app-specific dependencies",
        "severity": "none",
        "impact": "Files are generic utility logic"
      },
      {
        "factor": "Well-tested code",
        "severity": "none",
        "impact": "54 test cases provide confidence in refactoring"
      },
      {
        "factor": "Cross-file relative imports",
        "severity": "low",
        "impact": "scoringUtils depends on scoringConfig and types - must move together"
      }
    ],
    "breaking_changes_required": false,
    "backward_compatibility_maintainable": true
  }
}
