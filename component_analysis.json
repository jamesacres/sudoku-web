{
  "analysis_date": "2025-11-03",
  "project": "sudoku-web",
  "source_path": "apps/template/src/components",
  "target_path": "packages/ui/src/components",
  "summary": {
    "total_components": 20,
    "high_priority": 6,
    "medium_priority": 7,
    "low_priority": 7,
    "already_in_ui_package": 11
  },
  "components": [
    {
      "name": "ErrorBoundary",
      "path": "apps/template/src/components/ErrorBoundary/ErrorBoundary.tsx",
      "priority": "HIGH",
      "category": "Error Handling",
      "status": "Ready to move",
      "dependencies": [
        "React (Component, ReactNode)",
        "useState, useEffect (hooks)"
      ],
      "app_specific_context": "None - fully generic error boundary",
      "notes": "Generic React error boundary with localStorage reset capability. No app-specific code.",
      "target_location": "packages/ui/src/components/ErrorBoundary/",
      "refactoring_needed": false,
      "reason": "Pure presentational error handler with standard React APIs only"
    },
    {
      "name": "CopyButton",
      "path": "apps/template/src/components/CopyButton/CopyButton.tsx",
      "priority": "HIGH",
      "category": "Utility",
      "status": "Ready to move (minor cleanup)",
      "dependencies": [
        "@capacitor/share (Share)",
        "react-feather icons",
        "helpers/capacitor (isIOS)"
      ],
      "app_specific_context": "Uses isIOS from helpers, references 'Sudoku Race' and 'racing team' in share text (customizable)",
      "notes": "Generic copy-to-clipboard with platform-specific sharing. Share text is hardcoded app-specific content but can be parameterized.",
      "target_location": "packages/ui/src/components/CopyButton/",
      "refactoring_needed": true,
      "refactoring_details": [
        "Parameterize share title and team context text",
        "Extract hardcoded 'Sudoku Race' and 'racing team' strings to props"
      ],
      "reason": "Core functionality is generic; only share text messages are app-specific"
    },
    {
      "name": "GlobalErrorHandler",
      "path": "apps/template/src/components/GlobalErrorHandler/GlobalErrorHandler.tsx",
      "priority": "HIGH",
      "category": "Error Handling",
      "status": "Ready to move",
      "dependencies": [
        "React (useEffect)",
        "DOM APIs (document, window)"
      ],
      "app_specific_context": "None - generic global error handler",
      "notes": "Universal error handler for uncaught errors and unhandled promise rejections. Fully reusable.",
      "target_location": "packages/ui/src/components/GlobalErrorHandler/",
      "refactoring_needed": false,
      "reason": "Pure utility component with no app-specific logic"
    },
    {
      "name": "Toggle (NotesToggle)",
      "path": "apps/template/src/components/Toggle/NotesToggle.tsx",
      "priority": "HIGH",
      "category": "Form Control",
      "status": "Already in packages/ui",
      "dependencies": [
        "@headlessui/react (Switch)"
      ],
      "app_specific_context": "None - fully generic toggle switch",
      "notes": "Simple, reusable toggle switch component. Already exported from packages/ui.",
      "target_location": "packages/ui/src/components/Toggle/",
      "in_packages_ui": true,
      "refactoring_needed": false,
      "reason": "Already migrated to packages/ui"
    },
    {
      "name": "ThemeSwitch",
      "path": "apps/template/src/components/ThemeSwitch/ThemeSwitch.tsx",
      "priority": "HIGH",
      "category": "Theme Management",
      "status": "Already in packages/ui",
      "dependencies": [
        "next-themes (useTheme)",
        "@capacitor/status-bar",
        "helpers/capacitor (isCapacitor)"
      ],
      "app_specific_context": "None - fully generic dark/light mode toggle",
      "notes": "Dark/light mode toggle with Capacitor status bar sync. Fully reusable. Already in packages/ui.",
      "target_location": "packages/ui/src/components/ThemeSwitch/",
      "in_packages_ui": true,
      "refactoring_needed": false,
      "reason": "Already migrated to packages/ui"
    },
    {
      "name": "Footer",
      "path": "apps/template/src/components/Footer/Footer.tsx",
      "priority": "HIGH",
      "category": "Layout",
      "status": "Already in packages/ui",
      "dependencies": [
        "React (Children, ReactNode)",
        "helpers/capacitor (isCapacitor)"
      ],
      "app_specific_context": "None - generic layout wrapper",
      "notes": "Generic footer layout component. Accepts children for flexible content. Already in packages/ui.",
      "target_location": "packages/ui/src/components/Footer/",
      "in_packages_ui": true,
      "refactoring_needed": false,
      "reason": "Already migrated to packages/ui"
    },
    {
      "name": "HeaderBack",
      "path": "apps/template/src/components/HeaderBack/HeaderBack.tsx",
      "priority": "MEDIUM",
      "category": "Navigation",
      "status": "Ready to move (minor refactoring)",
      "dependencies": [
        "next/navigation (useRouter, usePathname)",
        "react-feather (ChevronLeft)"
      ],
      "app_specific_context": "Hardcoded 'Sudoku Race' title and route-specific logic (/?tab=START_PUZZLE)",
      "notes": "Back button with app-specific branding and routes. Can be made generic with parameterization.",
      "target_location": "packages/ui/src/components/HeaderBack/",
      "in_packages_ui": true,
      "refactoring_needed": true,
      "refactoring_details": [
        "Extract 'Sudoku Race' title to prop or context",
        "Parameterize home route and query parameters",
        "Create generic version that accepts custom home route config"
      ],
      "reason": "Core back button logic is generic; branding/routes are app-specific"
    },
    {
      "name": "CelebrationAnimation",
      "path": "apps/template/src/components/CelebrationAnimation/CelebrationAnimation.tsx",
      "priority": "HIGH",
      "category": "Animation",
      "status": "Already in packages/ui",
      "dependencies": [
        "React (useEffect, useState, RefObject)",
        "@capacitor-community/in-app-review",
        "helpers/capacitor (isCapacitor)"
      ],
      "app_specific_context": "In-app review request for 3rd completed game (Sudoku Race specific logic at line 127)",
      "notes": "Explosion animation for grid cells. In-app review is Sudoku-specific but can be made optional. Already in packages/ui but may need review for app-specific review logic.",
      "target_location": "packages/ui/src/components/CelebrationAnimation/",
      "in_packages_ui": true,
      "refactoring_needed": true,
      "refactoring_details": [
        "Make in-app review callback optional via props",
        "Remove hardcoded completedGamesCount === 2 check",
        "Parameterize review trigger logic"
      ],
      "reason": "Animation core is generic; app review trigger needs decoupling"
    },
    {
      "name": "ThemeControls",
      "path": "apps/template/src/components/ThemeControls/ThemeControls.tsx",
      "priority": "HIGH",
      "category": "Theme Management",
      "status": "Already in packages/ui",
      "dependencies": [
        "ThemeSwitch component",
        "ThemeColorSwitch component"
      ],
      "app_specific_context": "None - pure composition",
      "notes": "Composite component combining theme mode and color selection. Already in packages/ui.",
      "target_location": "packages/ui/src/components/ThemeControls/",
      "in_packages_ui": true,
      "refactoring_needed": false,
      "reason": "Already migrated to packages/ui"
    },
    {
      "name": "ThemeColorSwitch",
      "path": "apps/template/src/components/ThemeColorSwitch/ThemeColorSwitch.tsx",
      "priority": "MEDIUM",
      "category": "Theme Management",
      "status": "Ready to move (refactoring needed)",
      "dependencies": [
        "useThemeColor (provider hook)",
        "RevenueCatContext (app-specific subscription management)"
      ],
      "app_specific_context": "Revenue Cat subscription context - premium color feature gating",
      "notes": "Theme color picker with subscription-based premium colors. Revenue Cat dependency makes it app-specific but core color selection logic is reusable.",
      "target_location": "packages/ui/src/components/ThemeColorSwitch/",
      "in_packages_ui": true,
      "refactoring_needed": true,
      "refactoring_details": [
        "Extract RevenueCatContext dependency to props callback",
        "Create optional premium feature gating prop",
        "Allow apps to provide custom subscription check function",
        "Move to packages/ui with clear prop documentation for subscription handling"
      ],
      "reason": "Core color switching is generic; premium feature gating via context is app-specific"
    },
    {
      "name": "Header",
      "path": "apps/template/src/components/Header/Header.tsx",
      "priority": "MEDIUM",
      "category": "Layout",
      "status": "Ready to move (refactoring needed)",
      "dependencies": [
        "next/dynamic (dynamic import)",
        "HeaderUser component",
        "HeaderBack component",
        "HeaderOnline component",
        "ThemeControls component"
      ],
      "app_specific_context": "Hardcoded child components (HeaderUser, HeaderOnline, HeaderBack) - specific to Sudoku app",
      "notes": "App-specific header combining multiple components. Can be made more generic.",
      "target_location": "packages/ui/src/components/Header/",
      "in_packages_ui": true,
      "refactoring_needed": true,
      "refactoring_details": [
        "Make child components customizable via slots/render props",
        "Allow apps to compose their own header content",
        "Keep as template/example in packages/ui with flexibility for different app layouts"
      ],
      "reason": "Header structure is reusable but component composition is app-specific"
    },
    {
      "name": "HeaderOnline",
      "path": "apps/template/src/components/HeaderOnline/HeaderOnline.tsx",
      "priority": "LOW",
      "category": "Status Indicator",
      "status": "Can move with refactoring",
      "dependencies": [
        "hooks/online (useOnline)",
        "react-feather icons"
      ],
      "app_specific_context": "Uses app-specific useOnline hook; window.alert for demo feedback",
      "notes": "Online/offline status indicator. Depends on custom useOnline hook from apps/template.",
      "target_location": "packages/ui/src/components/HeaderOnline/",
      "in_packages_ui": false,
      "refactoring_needed": true,
      "refactoring_details": [
        "Extract useOnline dependency - move hook to packages/hooks or parameterize",
        "Replace window.alert with prop callback for custom handling",
        "Decouple from template-specific online status logic"
      ],
      "reason": "Generic appearance but depends on app-specific online detection hook"
    },
    {
      "name": "HeaderUser",
      "path": "apps/template/src/components/HeaderUser/HeaderUser.tsx",
      "priority": "LOW",
      "category": "User Management",
      "status": "App-specific, not suitable for packages/ui",
      "dependencies": [
        "providers/UserProvider (UserContext)",
        "hooks/online (useOnline)",
        "UserButton subcomponent"
      ],
      "app_specific_context": "UserContext from app's UserProvider - core app authentication logic",
      "notes": "User sign-in/logout button. Tightly coupled to app's authentication provider. Not reusable across apps.",
      "target_location": "N/A - keep in app",
      "in_packages_ui": false,
      "refactoring_needed": false,
      "reason": "Core app-specific authentication component - not generic UI"
    },
    {
      "name": "UserButton",
      "path": "apps/template/src/components/HeaderUser/UserButton.tsx",
      "priority": "LOW",
      "category": "User Management",
      "status": "App-specific, not suitable for packages/ui",
      "dependencies": [
        "types/userProfile (UserProfile)",
        "@headlessui/react (Popover, Dialog, Transition)",
        "UserPanel subcomponent",
        "UserAvatar subcomponent"
      ],
      "app_specific_context": "UserProfile type is app-specific; composes UserPanel and UserAvatar which are app-specific",
      "notes": "User profile popover/dialog. Core component for user management tied to app's user model.",
      "target_location": "N/A - keep in app",
      "in_packages_ui": false,
      "refactoring_needed": false,
      "reason": "User profile UI specific to app's UserProfile type and user management flow"
    },
    {
      "name": "UserAvatar",
      "path": "apps/template/src/components/HeaderUser/UserAvatar.tsx",
      "priority": "MEDIUM",
      "category": "User Management",
      "status": "Can move with refactoring",
      "dependencies": [
        "types/userProfile (UserProfile)",
        "next/image (Image)",
        "react-feather (User icon)"
      ],
      "app_specific_context": "Accepts UserProfile type but logic is generic image/fallback rendering",
      "notes": "Generic avatar display component. Core logic is reusable if UserProfile type is decoupled.",
      "target_location": "packages/ui/src/components/UserAvatar/",
      "in_packages_ui": false,
      "refactoring_needed": true,
      "refactoring_details": [
        "Remove UserProfile type dependency",
        "Accept generic user object with picture and name props",
        "Export as generic Avatar component",
        "Make type props optional for flexibility"
      ],
      "reason": "Avatar rendering logic is generic; only UserProfile type is app-specific"
    },
    {
      "name": "UserPanel",
      "path": "apps/template/src/components/HeaderUser/UserPanel.tsx",
      "priority": "LOW",
      "category": "User Management",
      "status": "App-specific with some reusable patterns",
      "dependencies": [
        "types/userProfile (UserProfile)",
        "RevenueCatContext (subscription management)",
        "hooks/serverStorage (deleteAccount)",
        "UserAvatar component",
        "DeleteAccountDialog component"
      ],
      "app_specific_context": "UserProfile type, RevenueCatContext, useServerStorage hook, hardcoded links (bubblyclouds.com, Sudoku Plus)",
      "notes": "User profile panel with subscription and account deletion. Multiple app-specific dependencies.",
      "target_location": "N/A - keep in app or create template",
      "in_packages_ui": false,
      "refactoring_needed": true,
      "refactoring_details": [
        "Extract to template/example in app packages",
        "Parameterize company branding (bubblyclouds.com)",
        "Parameterize subscription product name (Sudoku Plus)",
        "Make RevenueCatContext optional via props"
      ],
      "reason": "Complex component with multiple app-specific integrations - better as app template"
    },
    {
      "name": "DeleteAccountDialog",
      "path": "apps/template/src/components/HeaderUser/DeleteAccountDialog.tsx",
      "priority": "MEDIUM",
      "category": "User Management",
      "status": "Can move with minimal refactoring",
      "dependencies": [
        "@headlessui/react (Dialog, Transition)",
        "react-feather (AlertTriangle)"
      ],
      "app_specific_context": "Dialog title and confirmation text could be parameterized but otherwise generic",
      "notes": "Generic confirmation dialog pattern. Reusable across apps with customizable messaging.",
      "target_location": "packages/ui/src/components/DeleteAccountDialog/ or generic ConfirmDialog",
      "in_packages_ui": false,
      "refactoring_needed": true,
      "refactoring_details": [
        "Extract hardcoded text to props (title, description, confirmText, etc.)",
        "Create generic ConfirmDialog component",
        "DeleteAccountDialog becomes app-specific wrapper around ConfirmDialog"
      ],
      "reason": "Core dialog logic is generic; content is parameterizable"
    },
    {
      "name": "AppDownloadModal",
      "path": "apps/template/src/components/AppDownloadModal/AppDownloadModal.tsx",
      "priority": "LOW",
      "category": "Marketing/Promotion",
      "status": "App-specific, not suitable for packages/ui",
      "dependencies": [
        "@headlessui/react (Dialog, Transition)",
        "next/image (Image)",
        "react-feather icons",
        "helpers/capacitor"
      ],
      "app_specific_context": "App Store URLs (Apple/Google), deep link (com.bubblyclouds.sudoku), hardcoded app names and messaging",
      "notes": "App-specific download promotion modal. Tightly coupled to specific app store links and branding.",
      "target_location": "N/A - keep in app",
      "in_packages_ui": false,
      "refactoring_needed": false,
      "reason": "App-specific promotion content (store URLs, deep links, branding) not suitable for generic package"
    },
    {
      "name": "SocialProof",
      "path": "apps/template/src/components/SocialProof/SocialProof.tsx",
      "priority": "LOW",
      "category": "Marketing/Content",
      "status": "App-specific, not suitable for packages/ui",
      "dependencies": [
        "React (useEffect, useState)"
      ],
      "app_specific_context": "Hardcoded motivational messages specific to Sudoku racing game",
      "notes": "Displays rotating motivational messages. Messages are hardcoded and game-specific.",
      "target_location": "N/A - keep in app",
      "in_packages_ui": false,
      "refactoring_needed": false,
      "reason": "Content is hardcoded and game-specific - not reusable as-is"
    },
    {
      "name": "PremiumFeatures",
      "path": "apps/template/src/components/PremiumFeatures/PremiumFeatures.tsx",
      "priority": "LOW",
      "category": "Marketing/Content",
      "status": "App-specific, not suitable for packages/ui",
      "dependencies": [
        "RevenueCatContext (subscription management)",
        "types/subscriptionContext (SubscriptionContext)",
        "config/premiumFeatures (PREMIUM_FEATURES)"
      ],
      "app_specific_context": "Hardcoded premium features list specific to Sudoku app, RevenueCatContext for subscriptions",
      "notes": "Displays premium features with subscription gating. Content and logic are Sudoku-specific.",
      "target_location": "N/A - keep in app",
      "in_packages_ui": false,
      "refactoring_needed": false,
      "reason": "Content (feature list) and subscription logic are app-specific"
    }
  ],
  "recommendations": {
    "immediate_moves_high_priority": [
      {
        "component": "ErrorBoundary",
        "effort": "Minimal",
        "action": "Move directly to packages/ui/src/components/ErrorBoundary/"
      },
      {
        "component": "GlobalErrorHandler",
        "effort": "Minimal",
        "action": "Move directly to packages/ui/src/components/GlobalErrorHandler/"
      },
      {
        "component": "CelebrationAnimation",
        "effort": "Small refactoring",
        "action": "Already in packages/ui - review and refactor optional in-app review callback"
      }
    ],
    "refactoring_needed_medium_priority": [
      {
        "component": "CopyButton",
        "effort": "Small",
        "action": "Parameterize hardcoded share text strings via props before moving"
      },
      {
        "component": "HeaderBack",
        "effort": "Medium",
        "action": "Extract branding and route params to props/context before moving"
      },
      {
        "component": "ThemeColorSwitch",
        "effort": "Medium",
        "action": "Extract RevenueCatContext dependency to custom hooks/callbacks"
      },
      {
        "component": "UserAvatar",
        "effort": "Small",
        "action": "Generic avatar component - remove UserProfile type dependency"
      },
      {
        "component": "DeleteAccountDialog",
        "effort": "Small",
        "action": "Extract to generic ConfirmDialog with parameterizable content"
      }
    ],
    "already_in_packages_ui": [
      "Toggle (NotesToggle)",
      "ThemeSwitch",
      "Footer",
      "CelebrationAnimation",
      "ThemeControls",
      "ThemeColorSwitch (needs review)",
      "Header (needs review)"
    ],
    "keep_in_app_specific": [
      "HeaderUser - app authentication provider specific",
      "UserButton - user management flow specific",
      "UserPanel - complex multi-context specific component",
      "AppDownloadModal - app-specific store URLs and deep links",
      "SocialProof - game-specific messages",
      "PremiumFeatures - feature list and subscription specific"
    ]
  },
  "next_steps": [
    "1. Create ErrorBoundary in packages/ui/src/components/ErrorBoundary/",
    "2. Create GlobalErrorHandler in packages/ui/src/components/GlobalErrorHandler/",
    "3. Refactor CopyButton - parameterize share text, then move",
    "4. Review and refactor CelebrationAnimation in packages/ui for optional callbacks",
    "5. Refactor ThemeColorSwitch to decouple RevenueCat dependency",
    "6. Refactor HeaderBack to extract branding/routing",
    "7. Create generic UserAvatar in packages/ui",
    "8. Create generic ConfirmDialog in packages/ui, let DeleteAccountDialog wrap it",
    "9. Update apps/template/src/components/index.ts to import from @sudoku-web/ui",
    "10. Consider creating app-templates in packages for complex components like UserPanel"
  ]
}
